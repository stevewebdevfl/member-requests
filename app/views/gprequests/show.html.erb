<!-- app/views/gprequests/show.html.erb -->

<div class="container">
  <div class="your-req-page">
    <div class="row">
      <div class="md-col-12">
        <h2>
          Your Requests
        </h2>
      </div>
    </div>
    <div class="row subhead">
      <div class="md-col-12">
        <div class="session-info">
          <%= "You are logged in as #{session[:email]} (user id: #{session[:user_id]})" %>
        </div>
        <div id="flash-messages">
          <% flash.each do |key, value| %>
            <%= content_tag(:div, value, :class => "flash #{key}") %>
          <% end %>
        </div>
      </div>
    </div>
    <div class="row request-list">
      <div class="md-col-12">
        <% if @gprequests.count > 0 %>
          <thead>
            <tr>
              <th>Req ID</th>
              <th>Title</th>
              <th>Description</th>
              <th>Votes</th>
            </tr>
          </thead>
          <% @gprequests.each do |gprequest| %>
              <% vote_count = vote_count(gprequest) %>
              <table class="table table-striped">
                <tbody>
                  <tr>
                    <td><%= "#{gprequest.id}" %></td>
                    <td><%= "#{gprequest.title}" %></td>
                    <td><%= "#{gprequest.description}" %></td>
                    <td><%= "#{vote_count}" %></td> 
                  </tr>
                </tbody> 
              </table>
          <% end %>
        <% else %>
          <div class="no-open-req">
            <%= "You have no open requests" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
